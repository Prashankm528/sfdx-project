<template>
    <!--Modal Header-->
    <div class="modal-header slds-modal__header">
        <h2 class="slds-text-heading--medium"> New Objective</h2>
    </div>
    <!--End Modal Header-->

    <!--Modal Body-->
    <div class="slds-modal__content slds-p-around_medium slds-scrollable">
        <template if:true={hasRecordLoaded}>
            <lightning-record-edit-form object-api-name="CAJBP_Objective__c" record-type-id={recordTypeId} layout-type="full" onload={handleFormLoaded}>
                <div class="slds-is-relative">
                    <template if:true={showLoading}>
                        <lightning-spinner size="medium"></lightning-spinner>
                        <template if:false={isSaving}>
                            <div style="min-height: 200px;"></div>
                        </template>
                    </template>
                    <div class={formCss}>
                        <div class="slds-grid slds-wrap">
                            <div class="slds-col slds-size_1-of-2 slds-truncate">
                                <lightning-input-field field-name="Name" required></lightning-input-field>
                            </div>
                            <div class="slds-col slds-size_1-of-2 slds-truncate">
                                <lightning-input-field field-name="CAJBP_Joint_Business_Plan__c" value={recordId} disabled></lightning-input-field>
                            </div>
                            <div class="slds-col slds-size_1-of-2 slds-truncate">
                                <lightning-input-field field-name="CurrencyIsoCode" class="isoCode" value={jbpCurrencyIsoCode} required disabled></lightning-input-field>
                            </div>
                            <div class="slds-col slds-size_12-of-12">
                                <lightning-input-field field-name="CAJBP_Description__c" required></lightning-input-field>
                            </div>

                            <div class="slds-col slds-size_12-of-12 slds-truncate">
                                <c-cajbp-expandable-section title="Related SWOTs" icon-name="custom:custom74" id="swots">
                                    <div class="swots-container">
                                        <c-cajbp-objective-swots jbp-id={recordId} onloaded={handleSwotsLoaded}
                                                onerror={handleSwotsError} onsuccess={handleSwotsSuccess}>
                                        </c-cajbp-objective-swots>
                                    </div>
                                </c-cajbp-expandable-section>
                            </div>
                        </div>
                    </div>
                </div>
            </lightning-record-edit-form>
        </template>
        <template if:false={hasRecordLoaded}>
            <div class="slds-is-relative">
                <lightning-spinner size="medium"></lightning-spinner>
                <div style="min-height: 200px;"></div>
            </div>
        </template>
    </div>
    <!--End of Modal Body-->

    <!--Modal Footer-->
    <div class="modal-footer slds-modal__footer">
        <template if:false={isPageReady}>
            <lightning-button variant="brand" class="slds-p-right_x-small" label="Cancel" onclick={cancel}></lightning-button>
            <lightning-button variant="brand" label="Save" disabled></lightning-button>
        </template>
        <template if:true={isPageReady}>
            <template if:false={isSaving}>
                <lightning-button variant="brand" class="slds-p-right_x-small" label="Cancel" onclick={cancel}></lightning-button>
                <lightning-button variant="brand" label="Save" onclick={save}></lightning-button>
            </template>
            <template if:true={isSaving}>
                <lightning-button variant="brand" class="slds-p-right_x-small" label="Cancel" onclick={cancel} disabled></lightning-button>
                <lightning-button variant="brand" label="Save" disabled></lightning-button>
            </template>
        </template>
    </div>
    <!--End of Modal Footer-->
</template>